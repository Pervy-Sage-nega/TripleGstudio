{% extends 'layout.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    {% block head %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Meta Tags -->
    <title>{{ seo_meta.title }}</title>
    <meta name="description" content="{{ seo_meta.description }}">
    <meta name="keywords" content="{{ seo_meta.keywords }}">
    <link rel="canonical" href="{{ seo_meta.canonical_url }}">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="{{ seo_meta.og_title }}">
    <meta property="og:description" content="{{ seo_meta.og_description }}">
    <meta property="og:url" content="{{ seo_meta.og_url }}">
    <meta property="og:type" content="{{ seo_meta.og_type }}">
    <meta property="og:site_name" content="{{ seo_meta.og_site_name }}">
    {% if seo_meta.og_image %}
    <meta property="og:image" content="{{ seo_meta.og_image }}">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:alt" content="{{ project.hero_image_alt|default:project.title }}">
    {% endif %}
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="{{ seo_meta.twitter_card }}">
    <meta name="twitter:title" content="{{ seo_meta.twitter_title }}">
    <meta name="twitter:description" content="{{ seo_meta.twitter_description }}">
    {% if seo_meta.twitter_image %}
    <meta name="twitter:image" content="{{ seo_meta.twitter_image }}">
    <meta name="twitter:image:alt" content="{{ project.hero_image_alt|default:project.title }}">
    {% endif %}
    
    <!-- Project-specific Meta Tags -->
    {% if seo_meta.project_location %}
    <meta name="project:location" content="{{ seo_meta.project_location }}">
    {% endif %}
    {% if seo_meta.project_year %}
    <meta name="project:year" content="{{ seo_meta.project_year }}">
    {% endif %}
    {% if seo_meta.project_status %}
    <meta name="project:status" content="{{ seo_meta.project_status }}">
    {% endif %}
    {% if seo_meta.project_category %}
    <meta name="project:category" content="{{ seo_meta.project_category }}">
    {% endif %}
    {% if seo_meta.project_architect %}
    <meta name="project:architect" content="{{ seo_meta.project_architect }}">
    {% endif %}
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {{ structured_data|safe }}
    </script>
    
    <script type="application/ld+json">
    {{ breadcrumb_data|safe }}
    </script>
    
    <script type="application/ld+json">
    {{ organization_data|safe }}
    </script>
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/project-detail.css' %}">
    {% endblock %}
</head>
    <!-- Navigation -->
    {% block body %}
    
    <!-- Hero Section with Video Background -->
    <section class="project-hero">
        <div class="video-background">
            <video autoplay muted loop playsinline id="project-hero-video">
                {% if project.video %}
                    <source src="{{ project.video.url }}" type="video/mp4">
                {% else %}
                    <source src="{% static 'media/videos/Sksca9hO.mp4' %}" type="video/mp4">
                {% endif %}
                <!-- Fallback for browsers that don't support video tag -->
                Your browser does not support the video tag.
            </video>
            <div class="video-overlay"></div>
        </div>
        <div class="back-to-projects">
            <a href="{% url 'portfolio:project_list' %}"><i class="fas fa-arrow-left"></i> Back to Projects</a>
        </div>
        <div class="project-hero-content">
            <div class="project-category">{{ project.category.name|upper }}</div>
            <h1>{{ project.title }}</h1>
            <div class="project-location">
                <i class="fas fa-map-marker-alt"></i> {{ project.location }}
            </div>
        </div>
    </section>

    <main class="project-content">
        <!-- Project Overview Section -->
        <section class="project-overview">
            <div class="section-container">
                <h2 class="section-title">Project Overview</h2>
                
                <div class="overview-grid">
                    <div class="overview-details">
                        <div class="overview-text">
                            {{ project.description|linebreaks }}
                        </div>
                        
                        <div class="project-stats">
                            <div class="stat-item">
                                <div class="stat-label">Completion Date</div>
                                <div class="stat-value">{{ project.completion_date|date:"F Y" }}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Project Duration</div>
                                <div class="stat-value">{{ project.duration }}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Lead Architect</div>
                                <div class="stat-value">{{ project.lead_architect }}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Project Status</div>
                                <div class="stat-value status-{{ project.status }}">{{ project.get_status_display }}</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-label">Size</div>
                                <div class="stat-value">{{ project.size }}</div>
                            </div>
                            {% for stat in project_stats %}
                            <div class="stat-item">
                                <div class="stat-label">{{ stat.label }}</div>
                                <div class="stat-value">{{ stat.value }}</div>
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    
                    <div class="overview-image">
                
                        {% if project.hero_image %}
                            <img src="{{ project.hero_image.url }}?v={{ project.updated_at|date:'U' }}" 
                                 alt="{{ project.hero_image_alt|default:project.title|add:' Overview' }}" 
                                 onerror="console.log('Image failed to load: {{ project.hero_image.url }}'); this.src='{% static 'images/image1.jpg' %}';">
                        {% else %}
                            <p style="color: orange;">No hero image found, using fallback</p>
                            <img src="{% static 'images/image1.jpg' %}" alt="{{ project.title }} Overview">
                        {% endif %}
                    </div>
                </div>
            </div>
        </section>

        <!-- Photo Gallery Section -->
        <section class="project-gallery">
            <div class="section-container">
                <h2 class="section-title">Project Gallery</h2>
                
                <div class="gallery-grid">
                    {% for image in project_images %}
                    <div class="gallery-item">
                        <img src="{{ image.image.url }}" alt="{{ image.alt_text }}" onerror="this.src='/static/images/image1.jpg'">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                    {% empty %}
                    <!-- Show hero image if no gallery images exist -->
                    {% if project.hero_image %}
                    <div class="gallery-item">
                        <img src="{{ project.hero_image.url }}" alt="{{ project.title }} Hero Image">
                        <div class="gallery-overlay">
                            <i class="fas fa-search-plus"></i>
                        </div>
                    </div>
                    {% else %}
                    <div class="no-gallery">
                        <div class="no-gallery-content">
                            <i class="fas fa-images fa-3x"></i>
                            <h3>No Gallery Images</h3>
                            <p>Gallery images for this project will be available soon.</p>
                        </div>
                    </div>
                    {% endif %}
                    {% endfor %}
                </div>
            </div>
            
            <!-- Lightbox -->
            <div class="lightbox" id="gallery-lightbox">
                <div class="lightbox-content">
                    <span class="lightbox-close">&times;</span>
                    <img class="lightbox-image" id="lightbox-img">
                    <div class="lightbox-controls">
                        <button class="lightbox-prev"><i class="fas fa-chevron-left"></i></button>
                        <button class="lightbox-next"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Timeline/Milestones Section -->
        <section class="project-timeline">
            <div class="section-container">
                <h2 class="section-title">Project Timeline</h2>
                
                <div class="timeline">
                    {% for timeline_item in project_timeline %}
                    <div class="timeline-item {% if timeline_item.completed %}completed{% endif %}">
                        <div class="timeline-point"></div>
                        <div class="timeline-content">
                            <h3>{{ timeline_item.title }}</h3>
                            <span class="timeline-date">{{ timeline_item.date|date:"F Y" }}</span>
                            <p>{{ timeline_item.description }}</p>
                            <div class="progress-bar">
                          {% if timeline_item.completed %}
  <div class="progress" style="width: 100%"></div>
{% else %}
  <div class="progress" style="width: 0%"></div>
{% endif %}
                            </div>
                        </div>
                    </div>
                    {% empty %}
                    <!-- Fallback timeline if no timeline items exist -->
                    <div class="timeline-item completed">
                        <div class="timeline-point"></div>
                        <div class="timeline-content">
                            <h3>Project Completed</h3>
                            <span class="timeline-date">{{ project.completion_date|date:"F Y" }}</span>
                            <p>This project has been successfully completed and delivered.</p>
                            <div class="progress-bar">
                                <div class="progress" style="width: 100%"></div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </section>
        
        <!-- Call to Action -->
        <section class="project-cta">
            <div class="section-container">
                <div class="cta-content">
                    <h2>Ready to Build Your Dream Home?</h2>
                    <p>Let Triple G Studio bring your vision to life with our expert design and construction services.</p>
                    <div class="cta-buttons">
                        <a href="{% url 'core:contact' %}" class="btn-primary">Contact Us</a>
                        <a href="{% url 'portfolio:project_list' %}" class="btn-secondary">View More Projects</a>
                    </div>
                </div>
            </div>
        </section>
    </main>


    <script src="{% static 'js/project-detail.js' %}"></script>
    <script src="{% static 'js/chatbot.js' %}"></script>
    {% endblock %}
</body>
</html>